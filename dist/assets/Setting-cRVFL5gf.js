import{g as ve,h as de,t as I,i as a,c as x,A as z,k as ce,p as ge,o as he,b as ne,d as n,f as ue,e as fe,a as $e,v as _e,n as Se}from"./index-BhHlpicK.js";import{A as ye,o as pe,a as be}from"./svgIcons-wKczg7-q.js";import{F as me}from"./fetching-DWZPZ03v.js";import{c as P}from"./helper-Ay89jTCi.js";const xe="_storageContainer_1npyn_32",we="_storageChart_1npyn_39",Ce="_spaces_1npyn_67",Pe="_legendStorage_1npyn_80",Ie="_coloricon_1npyn_89",ke="_photos_1npyn_96",qe="_lives_1npyn_99",Ae="_videos_1npyn_102",De="_others_1npyn_105",Fe="_freeStorages_1npyn_108",Ee="_storage_1npyn_32",t={storageContainer:xe,storageChart:we,spaces:Ce,legendStorage:Pe,coloricon:Ie,photos:ke,lives:qe,videos:Ae,others:De,freeStorages:Fe,storage:Ee};var Be=I("<button popovertarget=account-popover>"),Le=I('<div popover=auto id=account-popover class="popover-container devices_filter_popover">');const Me=()=>{const r=ve(),{loggedUser:v}=de();return[(()=>{var s=Be();return s.style.setProperty("background-color","rgb(51,94,168)"),a(s,ye),s})(),(()=>{var s=Le();return a(s,x(z,{href:"/user",children:"Profile"}),null),a(s,x(ce,{get when(){return v.roleType==="admin"},get children(){return x(z,{href:"/user/admin",children:"Dashboard"})}}),null),a(s,x(z,{href:"#",onclick:async()=>{const l=await fetch("api/v1/user/logout");l.ok||console.log(l),r("/login")},children:"Logout"}),null),s})()]};var Ne=I("<div><div><div><span>Client Info</span><span> of <!> used</span></div><div><span></span><span></span></div><div><div></div> Used<div></div> Free");function Re(){const[r,v]=ge({quota:0,usage:0});async function s(){const l=await navigator.storage.estimate()||{};v({quota:l.quota||0,usage:l.usage||0})}return he(()=>{s()}),(()=>{var l=Ne(),c=l.firstChild,g=c.firstChild,i=g.firstChild,d=i.nextSibling,k=d.firstChild,q=k.nextSibling;q.nextSibling;var u=g.nextSibling,f=u.firstChild,p=f.nextSibling,A=u.nextSibling,b=A.firstChild,D=b.nextSibling,F=D.nextSibling;return a(d,()=>P(r().usage),k),a(d,()=>P(r().quota),q),ne(o=>{var $=t.storageContainer,_=t.storageChart,S=t.spaces,h=`${r().usage}%`,y=`${t.storage} ${t.others}`,m=`${r().quota-r().usage}%`,w=`${t.storage} ${t.freeStorages}`,E=t.legendStorage,C=`${t.coloricon} ${t.others}`,B=`${t.coloricon} ${t.freeStorages}`;return $!==o.e&&n(l,o.e=$),_!==o.t&&n(c,o.t=_),S!==o.a&&n(u,o.a=S),h!==o.o&&((o.o=h)!=null?f.style.setProperty("width",h):f.style.removeProperty("width")),y!==o.i&&n(f,o.i=y),m!==o.n&&((o.n=m)!=null?p.style.setProperty("width",m):p.style.removeProperty("width")),w!==o.s&&n(p,o.s=w),E!==o.h&&n(A,o.h=E),C!==o.r&&n(b,o.r=C),B!==o.d&&n(F,o.d=B),o},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),l})()}var Ue=I("<button popovertarget=setting-contents>"),ze=I("<div popover=auto id=setting-contents class=setting_contents><header><div inert><h1>Server Info</h1></div><div class=buttonContainer></div></header><div><div><div><span>Storage</span><span> of <!> used</span></div><div><span></span><span></span><span></span><span></span><span></span></div><div><div></div> Photos<div></div> Lives<div></div> Videos<div></div> Others<div></div> Free</div></div></div><button class=closeButton>");const ie={total:0,used:0,free:0,photo:0,live:0,video:0,all:0,other:0},He=()=>{const[r,v]=ue(ie),[s,{refetch:l}]=fe(async()=>{try{const i=await me();i&&v(Oe(i))}catch(i){console.error("Error fetching server capacity:",i)}}),c=$e(()=>{const{used:i,total:d}=r;return{used:P(i),total:P(d),freeSpace:P(d-i)}});let g;return[(()=>{var i=Ue();return i.$$click=()=>l(),a(i,pe),i})(),(()=>{var i=ze(),d=i.firstChild,k=d.firstChild,q=k.nextSibling,u=d.nextSibling,f=u.firstChild,p=f.firstChild,A=p.firstChild,b=A.nextSibling,D=b.firstChild,F=D.nextSibling;F.nextSibling;var o=p.nextSibling,$=o.firstChild,_=$.nextSibling,S=_.nextSibling,h=S.nextSibling,y=h.nextSibling,m=o.nextSibling,w=m.firstChild,E=w.nextSibling,C=E.nextSibling,B=C.nextSibling,O=B.nextSibling,se=O.nextSibling,T=se.nextSibling,le=T.nextSibling,ae=le.nextSibling,V=u.nextSibling;return _e(e=>g=e,i),d.style.setProperty("position","relative"),a(q,x(Me,{})),a(b,()=>c().used,D),a(b,()=>c().total,F),a(y,()=>c().freeSpace),V.$$click=()=>{g&&g.hidePopover()},a(V,be),a(i,x(Re,{}),null),ne(e=>{var j=t.storageContainer,G=t.storageChart,H=t.spaces,L=`${r.photo}%`,J=`${t.storage} ${t.photos}`,M=`${r.live}%`,K=`${t.storage} ${t.lives}`,N=`${r.video}%`,Q=`${t.storage} ${t.videos}`,R=`${r.other}%`,W=`${t.storage} ${t.others}`,U=`${r.free}%`,X=`${t.storage} ${t.freeStorages}`,Y=t.legendStorage,Z=`${t.coloricon} ${t.photos}`,ee=`${t.coloricon} ${t.lives}`,te=`${t.coloricon} ${t.videos}`,oe=`${t.coloricon} ${t.others}`,re=`${t.coloricon} ${t.freeStorages}`;return j!==e.e&&n(u,e.e=j),G!==e.t&&n(f,e.t=G),H!==e.a&&n(o,e.a=H),L!==e.o&&((e.o=L)!=null?$.style.setProperty("width",L):$.style.removeProperty("width")),J!==e.i&&n($,e.i=J),M!==e.n&&((e.n=M)!=null?_.style.setProperty("width",M):_.style.removeProperty("width")),K!==e.s&&n(_,e.s=K),N!==e.h&&((e.h=N)!=null?S.style.setProperty("width",N):S.style.removeProperty("width")),Q!==e.r&&n(S,e.r=Q),R!==e.d&&((e.d=R)!=null?h.style.setProperty("width",R):h.style.removeProperty("width")),W!==e.l&&n(h,e.l=W),U!==e.u&&((e.u=U)!=null?y.style.setProperty("width",U):y.style.removeProperty("width")),X!==e.c&&n(y,e.c=X),Y!==e.w&&n(m,e.w=Y),Z!==e.m&&n(w,e.m=Z),ee!==e.f&&n(C,e.f=ee),te!==e.y&&n(O,e.y=te),oe!==e.g&&n(T,e.g=oe),re!==e.p&&n(ae,e.p=re),e},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0,c:void 0,w:void 0,m:void 0,f:void 0,y:void 0,g:void 0,p:void 0}),i})()]},Oe=r=>{if(!r)return ie;const v=r.total,s=r.used,l=r.photo/v*100,c=r.live/v*100,g=r.video/v*100,i=(s-r.all)/v*100;return{free:r.free/v*100,photo:l,live:c,video:g,other:i,total:v,used:s,all:r.all}};Se(["click"]);export{He as default};
