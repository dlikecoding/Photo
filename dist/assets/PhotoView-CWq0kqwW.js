import{q as Qe,p as j,c as g,r as et,f as re,a as B,t as w,v as ne,i as u,b as P,d as x,k as A,M as te,S as fe,s as U,n as N,e as pe,F as ve,j as ae,P as Ee,w as Le,m as K,V as tt,x as Te,y as oe,o as de,z as $e,I as _t}from"./index-DEGSL-2v.js";import{S as be,s as le,u as ft,a as nt,b as it,c as pt}from"./SlideUp-BIPXj_AL.js";import{u as ie,a as ot,b as rt,Z as yt}from"./ManageUrl-DQr7D2w5.js";import{g as $t,h as bt,i as wt,j as Ct,k as It,l as xt,m as St,n as Mt,o as kt,p as Pt,q as Et,r as Lt,s as Re}from"./fetching-DWZPZ03v.js";import Tt from"./NotFound-BIA5YLEP.js";import{b as Dt,F as Bt,Z as De,M as Ot,c as At,R as Ft,U as zt,D as Vt,I as Nt,G as lt,d as st,E as Rt,a as Ut,e as jt,f as Zt,g as Ht,h as Gt,i as Wt,j as at,k as Yt,l as qt,m as Kt}from"./svgIcons-CWi8yQy6.js";import{L as dt}from"./Loading-DyQQoSrW.js";import{f as Se,c as Ue,s as Xt,a as je,b as Jt,d as Qt,g as en}from"./helper-Ay89jTCi.js";const ct=et(),tn=e=>{const[t,i]=j(new Map),[s,d]=j(!1),n=(v,m)=>{i(new Map([[v,m]]))};return g(ct.Provider,{value:{items:t,setOneItem:n,setItems:i,isSelected:s,setIsSelected:d},get children(){return e.children}})},G=()=>Qe(ct),ut=et(),nn=e=>{const[t,i]=re([]),[s,d]=re(He()),n=()=>{h(Ze())},v=()=>{d(He())};B(()=>{s.isOpen||d("isEditing",!1)}),B(()=>{s.isEditing&&d("showImage",!0)});const[m,h]=re(Ze()),[$,c]=re(Me());return g(ut.Provider,{value:{displayMedias:t,setDisplayMedia:i,openModal:s,setOpenModal:d,mouseGesture:m,setMouseGesture:h,translate:$,setTranslate:c,resetModal:v,resetMouse:n},get children(){return e.children}})},Z=()=>Qe(ut),Me=()=>({x:0,y:0}),Ze=()=>({start:Me(),end:Me(),action:"",drag:!1,status:!1}),He=()=>({isOpen:!1,activeIdx:-1,startFocus:!1,startRect:void 0,isEditing:!1,showImage:!1}),on="_virtualContainer_1337e_5",rn="_mediaContainer_1337e_13",ln="_customBottomPadding_1337e_23",sn="_imageContainer_1337e_38",an="_cover_1337e_53",dn="_contain_1337e_58",cn="_selectedIcon_1337e_69",un="_overlayText_1337e_81",vn="_overlayLive_1337e_90",mn="_overlayFavorite_1337e_101",hn="_grayscale_1337e_112",Q={virtualContainer:on,mediaContainer:rn,customBottomPadding:ln,imageContainer:sn,cover:an,contain:dn,selectedIcon:cn,overlayText:un,overlayLive:vn,overlayFavorite:mn,grayscale:hn};var _e=w("<div>"),gn=w('<div><div inert><img alt="Image not found">');const _n=e=>{const t=()=>e.index,i=()=>e.media,s=()=>e.lastItem,d=()=>e.itemDim,{items:n,setItems:v,setOneItem:m,isSelected:h}=G(),{view:$}=ie(),{setOpenModal:c}=Z(),p=(l,o)=>{if(!h())return window.history.pushState({state:"Photo Modal"},"",window.location.href),m(l,o),c("isOpen",!0);const r=new Map(n());r.has(l)?r.delete(l):r.set(l,o),v(r)},f=B(()=>({top:Math.floor(t()/$.nColumn)*d()+Pe,left:t()%$.nColumn*d(),size:d()}));return(()=>{var l=gn(),o=l.firstChild,r=o.firstChild;l.$$click=()=>p(t(),i().media_id);var _=s();return typeof _=="function"&&ne(_,l),u(o,g(A,{get when(){return n().has(t())},get children(){var a=_e();return P(()=>x(a,Q.selectedIcon)),a}}),r),u(o,g(A,{get when(){return i().favorite},get children(){var a=_e();return P(()=>x(a,Q.overlayFavorite)),a}}),r),u(o,g(fe,{get children(){return[g(te,{get when(){return i().file_type==="Live"},get children(){var a=_e();return P(()=>x(a,Q.overlayLive)),a}}),g(te,{get when(){return i().file_type==="Video"},get children(){var a=_e();return u(a,()=>i().video_duration),P(()=>x(a,Q.overlayText)),a}})]}}),r),P(a=>{var b=Q.mediaContainer,y=`${f().top}px`,S=`${f().left}px`,M=`${f().size}px`,O=`${f().size}px`,L=i().media_id,z=t(),T=Q.imageContainer,I=i().thumb_path,k=`${$.objectFit?Q.cover:Q.contain} ${n().has(t())?Q.grayscale:""}`;return b!==a.e&&x(l,a.e=b),y!==a.t&&((a.t=y)!=null?l.style.setProperty("top",y):l.style.removeProperty("top")),S!==a.a&&((a.a=S)!=null?l.style.setProperty("left",S):l.style.removeProperty("left")),M!==a.o&&((a.o=M)!=null?l.style.setProperty("width",M):l.style.removeProperty("width")),O!==a.i&&((a.i=O)!=null?l.style.setProperty("height",O):l.style.removeProperty("height")),L!==a.n&&U(l,"data-id",a.n=L),z!==a.s&&U(l,"data-idx",a.s=z),T!==a.h&&x(o,a.h=T),I!==a.r&&U(r,"src",a.r=I),k!==a.d&&x(r,a.d=k),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0}),l})()};N(["click"]);var fn=w("<button popovertarget=devices-filter-popover>"),pn=w('<div popover=auto id=devices-filter-popover class="popover-container devices_filter_popover"><span class=clear_button>Clear Filter'),yn=w("<div>");const $n=()=>{const{isSelected:e}=G(),{updatePageKey:t}=ie(),[i]=pe($t),[s,d]=j(null);return g(A,{get when(){return!e()},get children(){return[(()=>{var n=fn();return u(n,Dt),n})(),(()=>{var n=pn(),v=n.firstChild;return n.style.setProperty("transform-origin","top center"),v.$$click=m=>{m.stopPropagation(),t("filterDevice",void 0)},u(n,g(ve,{get each(){return i()},children:m=>(()=>{var h=yn();return h.$$click=$=>{$.stopPropagation(),d(m.camera_id),t("filterDevice",m.camera_id)},u(h,()=>m.model),P(()=>x(h,s()===m.camera_id?"activeFilter":"")),h})()}),null),n})()]}})};N(["click"]);var bn=w("<button>");const wn=e=>{const{items:t}=G(),{openModal:i,displayMedias:s}=Z(),d=B(()=>{if(!i.isOpen||!t().size)return!1;const n=t().keys().next().value;return n===void 0||n<0?!1:s[n]?s[n].favorite:!1});return(()=>{var n=bn();return ae(n,"click",e.action,!0),u(n,()=>Bt(d())),n})()};N(["click"]);const Cn="_albumAddContainer_glotl_5",In="_header_glotl_27",xn="_dialogContainer_glotl_60",Sn="_dialogHeader_glotl_81",Mn="_dialogTitle_glotl_85",kn="_dialogSubtitle_glotl_91",Pn="_inputContainer_glotl_97",En="_dialogButtons_glotl_120",Ln="_cancelBtn_glotl_134",Tn="_saveBtn_glotl_138",Dn="_listOfAlbums_glotl_143",J={albumAddContainer:Cn,header:In,dialogContainer:xn,dialogHeader:Sn,dialogTitle:Mn,dialogSubtitle:kn,inputContainer:Pn,dialogButtons:En,cancelBtn:Ln,saveBtn:Tn,listOfAlbums:Dn};var Bn=w("<div><div><button>Cancel</button><h4>Add to </h4><button></button></div><dialog id=dialogCollectionContainer><div><div>New </div><div>Enter a name for this <!>.</div></div><div><input type=text placeholder=Title></div><div><button>Cancel</button><button>Create</button></div></dialog><h4>s</h4><div>"),On=w("<div><img><div></div><text>");const An=e=>{const{items:t,setIsSelected:i}=G(),[s]=pe(e.fetchItems),[d,n]=j(""),v=async(m,h)=>{const $=Array.from(t().values());return(await e.updateItems($,m,h)).ok?(e.setAddToCollection(!1),i(!1),!0):(alert(`Cannot add elements to ${e.entityType.toLowerCase()}`),!1)};return g(Ee,{get children(){var m=Bn(),h=m.firstChild,$=h.firstChild,c=$.nextSibling;c.firstChild;var p=c.nextSibling,f=h.nextSibling,l=f.firstChild,o=l.firstChild;o.firstChild;var r=o.nextSibling,_=r.firstChild,a=_.nextSibling;a.nextSibling;var b=l.nextSibling,y=b.firstChild,S=b.nextSibling,M=S.firstChild,O=M.nextSibling,L=f.nextSibling,z=L.firstChild,T=L.nextSibling;return $.$$click=()=>e.setAddToCollection(!1),u(c,()=>e.entityType,null),p.$$click=()=>{const I=document.getElementById("dialogCollectionContainer");I&&I.showModal()},u(p,De),u(o,()=>e.entityType,null),u(r,()=>e.entityType.toLowerCase(),a),ae(y,"input",I=>n(I.target.value)),M.$$click=()=>{n("");const I=document.getElementById("dialogCollectionContainer");I&&I.close()},O.$$click=async()=>{await v(void 0,d())},u(L,()=>e.entityType,z),u(T,g(ve,{get each(){return s()},children:I=>(()=>{var k=On(),C=k.firstChild,D=C.nextSibling,R=D.nextSibling;return k.$$click=async()=>{await v(I[e.entityType==="Album"?"album_id":"class_id"])},u(D,()=>I.title),u(R,()=>I.media_count),P(E=>{var H=I.thumb_path,Y=I.title;return H!==E.e&&U(C,"src",E.e=H),Y!==E.t&&U(C,"alt",E.t=Y),E},{e:void 0,t:void 0}),k})()})),P(I=>{var k=J.albumAddContainer,C=J.header,D=J.dialogContainer,R=J.dialogHeader,E=J.dialogTitle,H=J.dialogSubtitle,Y=J.inputContainer,ee=J.dialogButtons,q=J.cancelBtn,X=J.saveBtn,he=!d().trim(),ce=J.listOfAlbums;return k!==I.e&&x(m,I.e=k),C!==I.t&&x(h,I.t=C),D!==I.a&&x(f,I.a=D),R!==I.o&&x(l,I.o=R),E!==I.i&&x(o,I.i=E),H!==I.n&&x(r,I.n=H),Y!==I.s&&x(b,I.s=Y),ee!==I.h&&x(S,I.h=ee),q!==I.r&&x(M,I.r=q),X!==I.d&&x(O,I.d=X),he!==I.l&&(O.disabled=I.l=he),ce!==I.u&&x(T,I.u=ce),I},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0,d:void 0,l:void 0,u:void 0}),P(()=>y.value=d()),m}})};N(["click"]);var Fn=w("<button popovertarget=actions_contents>"),zn=w("<div>Remove from Album"),Vn=w("<div>Add to Album"),Nn=w('<div popover=auto id=actions_contents class="popover-container actions_contents"><div>Hide</div><div>Slideshow (...)');const Rn=e=>{const t=Le(),{items:i,setItems:s,setIsSelected:d}=G(),{setDisplayMedia:n}=Z(),[v,m]=j(!1),h=()=>{m(!0),document.getElementById("actions_contents")?.hidePopover()},$=async()=>{const c=new Set(i().values());(await Ct([...c],parseInt(t.id))).ok||alert("Failed to remove media from album!"),n(f=>f.filter((l,o)=>!c.has(l.media_id))),d(!1),s(new Map)};return[(()=>{var c=Fn();return u(c,Ot),c})(),(()=>{var c=Nn(),p=c.firstChild;return u(c,g(A,{get when(){return t.pages==="album"},get children(){var f=zn();return f.$$click=$,f}}),p),u(c,g(A,{get when(){return t.pages!=="album"},get children(){var f=Vn();return f.$$click=h,f}}),p),ae(p,"click",e.hide,!0),c})(),g(A,{get when(){return v()},get children(){return g(An,{setAddToCollection:m,entityType:"Album",fetchItems:wt,updateItems:bt})}})]};N(["click"]);var Un=w("<button>");const jn=1*1024**3,Ge=10,Zn=50*1024**2,Hn=()=>{const{items:e,setItems:t,setIsSelected:i}=G(),{openModal:s,displayMedias:d}=Z(),[n,v]=j(!1),m=async h=>{if(h.preventDefault(),h.stopPropagation(),!e()||!e().size)return;const $=Gn(e(),d);if($){if($.canShare){if(!await Wn($.medias,v))return}else v(!0),await qn(e()),v(!1);s()||(i(!1),t(new Map))}};return[(()=>{var h=Un();return h.$$click=$=>m($),u(h,At),h})(),g(A,{get when(){return n()},get children(){return g(dt,{})}})]},Gn=(e,t)=>{if(e.size>Ge)return alert(`You can only select up to ${Ge} files.`),null;let s=0;const d=[];for(const[n,v]of e){const m=t[n];if(s+=Number(m.file_size),s>jn)return alert("Selected files exceeds 1GB limit."),null;d.push(m)}return{medias:d,canShare:s<=Zn}},Wn=async(e,t)=>{const i=[];t(!0);for(const s of e){const d=await Yn(s.source_file);d&&i.push(d)}t(!1);try{if(navigator.canShare&&navigator.canShare({files:i}))return await navigator.share({files:i}),!0}catch(s){return console.log(`Error sharing files: ${s}`),!1}},Yn=async e=>{try{const t=await fetch(e,{method:"GET",credentials:"same-origin"});if(!t.ok)throw new Error(`Failed fetch: ${e}`);const i=await t.blob(),s=e.split("/").pop()||"file";return new File([i],s)}catch(t){return console.error("Fetch file error:",t),null}},qn=async e=>{const t=new Set(e.values()),i=await It([...t]);if(!i.ok)return alert("Failed to download photos/video.");const s=await i.blob(),d=URL.createObjectURL(s),n=document.createElement("a");n.href=d,n.download="PhotoX.zip",n.rel="noopener",n.target="_blank",n.style.display="none",document.body.appendChild(n),n.click(),document.body.removeChild(n),setTimeout(()=>URL.revokeObjectURL(d),1e3)};N(["click"]);var Kn=w("<button popovertarget=recover-contents>");const Xn=e=>{const{items:t}=G(),i=()=>`Recover ${t().size} Photo(s)`;return[(()=>{var s=Kn();return u(s,Ft),s})(),g(be,{idElement:"recover-contents",noticeText:"Recovery deleted media back to server",get confirmBtn(){return e.action},infoText:i})]};var Jn=w("<button>");const Qn=e=>(()=>{var t=Jn();return ae(t,"click",e.action,!0),u(t,zt),t})();N(["click"]);var ei=w("<button popovertarget=delete-contents>");const ti=e=>{const{items:t,setItems:i,setIsSelected:s}=G(),{displayMedias:d,setDisplayMedia:n}=Z(),v=async()=>{const c=new Set(t().values());n(f=>f.filter((l,o)=>!c.has(l.media_id))),s(!1),i(new Map);const p=await xt([...c]);if(!p.ok)return console.error(`Failed to delete ${c}:`,p);d.length>0||window.history.back()},m=e.isDeletePage?"The photo(s) will be moved to the Recently Deleted for 30 days before being permanently deleted.":"This will permanently delete the selected photo(s). This action can't be undone",h=()=>e.isDeletePage?e.delete():v(),$=()=>`Delete ${t().size} Photo(s)`;return[(()=>{var c=ei();return u(c,Vt),c})(),g(be,{idElement:"delete-contents",noticeText:m,confirmBtn:h,infoText:$})]};var ni=w("<button popovertarget=information-popover>"),ii=w("<div><div><input type=text><button></button></div><div><div></div><button>Adjust</button></div><p></p><div><div><p></p><p></p></div><div></div><div></div><div><p>Posted: </p><p>By </p></div></div><div>"),oi=w("<div popover=auto id=information-popover>"),ri=w("<p> FPS"),li=w("<p>");const si=()=>{const{items:e}=G();let t=null,i=null;const[s,d]=j(!0),[n,v]=re(di),m=async()=>{if(s())d(!1),i?.focus();else{d(!0);const c=e().values().next().value;if(!c)return alert("No valid photo/video to update");if(!i||i.value.trim().length===0||i.value==="Add a Caption")return alert("Please enter new data to update this caption.");if(i.value.trim()===n.caption)return;const f=await Mt(c,i.value);if(!f.ok)return console.log(await f.json());v("caption",i.value)}},h=async()=>{const c=e().values().next().value;if(!c)return alert("No valid photo/video to get info");if(n.media_id===c)return;const p=await St(c);if(!p)return console.log("Missing info");v(p)};B(()=>{e()&&(t?.hidePopover(),d(!0))});const $=B(()=>{if(!n)return"";const c=Se(n.create_date);return`${c.weekday} • ${c.date} • ${c.time}`});return[(()=>{var c=ni();return c.$$click=h,u(c,Nt),c})(),(()=>{var c=oi();return ne(p=>t=p,c),c.style.setProperty("max-width","600px"),c.style.setProperty("width","100%"),c.style.setProperty("border-radius","0"),u(c,g(A,{when:n,get children(){var p=ii(),f=p.firstChild,l=f.firstChild,o=l.nextSibling,r=f.nextSibling,_=r.firstChild,a=r.nextSibling,b=a.nextSibling,y=b.firstChild,S=y.firstChild,M=S.nextSibling,O=y.nextSibling,L=O.nextSibling,z=L.nextSibling,T=z.firstChild;T.firstChild;var I=T.nextSibling;I.firstChild;var k=b.nextSibling;return ne(C=>i=C,l),l.style.setProperty("pointer-events","auto"),o.$$click=m,u(o,(()=>{var C=K(()=>!!s());return()=>C()?lt():st()})()),u(_,()=>$()||"Wednesday • Aug 8, 2012 • 2:55 PM {wrong}"),u(a,()=>n.file_name),u(S,()=>n.make&&n.model||"UNKNOWN CAMERA"),u(M,()=>n.file_ext),u(O,()=>n.lens_model||"No lens infomation"),u(L,(()=>{var C=K(()=>n.file_type!=="Photo");return()=>C()?`${ai(n)}P • `:""})(),null),u(L,()=>n.megapixels?`${n.megapixels} MP • `:"",null),u(L,()=>n.image_height?`${n.image_height} × ${n.image_width}`:"Video",null),u(L,(()=>{var C=K(()=>!!Ue(n.file_size));return()=>C()?` • ${Ue(n.file_size)}`:""})(),null),u(z,(()=>{var C=K(()=>!!n.frame_rate);return()=>C()&&(()=>{var D=ri(),R=D.firstChild;return u(D,()=>n.frame_rate,R),D})()})(),T),u(z,(()=>{var C=K(()=>!!n.video_duration);return()=>C()&&(()=>{var D=li();return u(D,()=>n.video_duration),D})()})(),T),u(T,()=>Se(n.upload_at).date,null),u(I,()=>n.user_name||"Unknown",null),u(k,()=>n.city?`${n.city}, ${n.state}`:"Add a location ..."),P(C=>{var D=le.mediaInfo,R=le.caption,E=s(),H=le.dateInfo,Y=le.infoOfMedia,ee=le.cameraInfo,q=le.addLocation;return D!==C.e&&x(p,C.e=D),R!==C.t&&x(f,C.t=R),E!==C.a&&(l.disabled=C.a=E),H!==C.o&&x(r,C.o=H),Y!==C.i&&x(b,C.i=Y),ee!==C.n&&x(y,C.n=ee),q!==C.s&&x(k,C.s=q),C},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0}),P(()=>l.value=n.caption||"Add a Caption"),p}})),P(()=>x(c,le.slideupContents)),c})()]},ai=e=>{if(!e)return 0;const t=e.image_width,i=e.image_height;return!t||!i?0:Math.min(parseInt(t),parseInt(i))},di={caption:"",create_date:"",file_ext:"",file_name:"",file_size:0,file_type:"",city:"",state:"",make:"",media_id:0,mime_type:"",model:"",orientation:"",software:"",upload_at:"",user_name:"",image_height:"",image_width:"",lens_model:"",megapixels:"",title:"",frame_rate:0,video_duration:"",duration:0};N(["click"]);var ci=w("<button popovertarget=delete-all-contents>Delete All");const ui=()=>{const{items:e,setItems:t,setIsSelected:i}=G(),{displayMedias:s,setDisplayMedia:d}=Z(),n="This will permanently delete all photo(s) & video(s) in Recently Deleted. This action can't be undone",v=async()=>{await kt(),d([]),i(!1),t(new Map),!(s.length>0)&&window.history.back()},m=()=>`Delete ${e().size<250?s.length:"All"} Photo(s)`;return[ci(),g(be,{idElement:"delete-all-contents",noticeText:n,confirmBtn:v,infoText:m})]};var vi=w("<button popovertarget=merge-all-contents>Merge All");const mi=()=>{const{items:e,setItems:t,setIsSelected:i}=G(),{displayMedias:s,setDisplayMedia:d}=Z(),n="This will merges all duplicate photo(s) to one. This action can't be undone",v=async()=>{await Pt(),d([]),i(!1),t(new Map),window.history.back()},m=()=>`Merge ${e().size<250?s.length:"All"} Photo(s)`;return[vi(),g(be,{idElement:"merge-all-contents",noticeText:n,confirmBtn:v,infoText:m})]};var hi=w("<button>"),gi=w("<button inert>"),_i=w('<footer><div class="actions__toolbar__column is_left"></div><div class="actions__toolbar__column is_middle"></div><div class="actions__toolbar__column is_right">');const We=e=>({default:e?["save","favorite","info","edit","delete"]:["save","favorite","count","more","delete"],deleted:e?["recover","permanentDelete"]:["recover","count","permanentDelete","permanentDeleteAll"],hidden:e?["unhide","delete"]:["unhide","count","delete"],duplicate:e?["permanentDelete"]:["mergeAll","count","permanentDelete"]}),vt=()=>{const{items:e,setItems:t,setIsSelected:i}=G(),s=Le(),{openModal:d,setOpenModal:n,displayMedias:v,setDisplayMedia:m}=Z(),h={delete:()=>$("deleted",!0),recovery:()=>$("deleted",!1),favorite:()=>$("favorite"),hide:()=>$("hidden",!0),unhide:()=>$("hidden",!1)},$=async(f,l)=>{if(e().size<1)return;const o=new Set(e().values()),r=[...e().keys()];if(f==="favorite"){const a=r.some(b=>!v[b].favorite);l=a,m(r,"favorite",a)}else m(a=>a.filter((b,y)=>!o.has(b.media_id)));const _=await Et([...o],f,l);_.ok||console.error(`Failed to update ${f}:`,_),!d.isOpen&&(i(!1),t(new Map),!(v.length>0)&&window.history.back())},c=We(d.isOpen)[s.pages]||We(d.isOpen).default,p=()=>e().size<1;return(()=>{var f=_i(),l=f.firstChild,o=l.nextSibling,r=o.nextSibling;return f.style.setProperty("z-index","10"),u(l,g(fe,{get fallback(){return g(Hn,{})},get children(){return[g(te,{get when(){return c.includes("unhide")},get children(){return g(Qn,{get action(){return h.unhide}})}}),g(te,{get when(){return c.includes("recover")},get children(){return g(Xn,{get action(){return h.recovery}})}})]}})),u(o,g(A,{get when(){return c.includes("favorite")},get children(){return g(wn,{get action(){return h.favorite}})}}),null),u(o,g(A,{get when(){return c.includes("info")},get children(){return g(si,{})}}),null),u(o,g(A,{get when(){return c.includes("edit")},get children(){var _=hi();return _.$$click=()=>n("isEditing",!0),u(_,Rt),_}}),null),u(o,g(fe,{get children(){return[g(te,{get when(){return K(()=>!!c.includes("permanentDeleteAll"))()&&e().size===1},get children(){return g(ui,{})}}),g(te,{get when(){return K(()=>!!c.includes("mergeAll"))()&&e().size===1},get children(){return g(mi,{})}}),g(te,{get when(){return c.includes("count")},get children(){var _=gi();return _.style.setProperty("pointer-events","none"),u(_,()=>e().size),_}})]}}),null),u(o,g(A,{get when(){return c.includes("more")},get children(){return g(Rn,{get hide(){return h.hide}})}}),null),u(r,g(ti,{get delete(){return h.delete},get isDeletePage(){return c.includes("delete")}})),P(_=>{var a=p(),b=`${p()?"footerDisabled":""}`,y=!c.includes("favorite")&&d.isOpen?"hidden":"visible";return a!==_.e&&(f.inert=_.e=a),b!==_.t&&x(f,_.t=b),y!==_.a&&((_.a=y)!=null?o.style.setProperty("visibility",y):o.style.removeProperty("visibility")),_},{e:void 0,t:void 0,a:void 0}),f})()};N(["click"]);var fi=w("<button>");const pi=()=>{const{setItems:e,isSelected:t,setIsSelected:i}=G();return B(()=>{t()?document.querySelectorAll(".footer_nav").forEach(s=>{s.classList.add("hideFooter")}):(document.querySelectorAll(".footer_nav").forEach(s=>{s.classList.remove("hideFooter")}),e(new Map))}),(()=>{var s=fi();return s.$$click=()=>i(d=>!d),s.style.setProperty("padding-left","15px"),s.style.setProperty("padding-right","15px"),u(s,()=>t()?"Cancel":"Select"),s})()};N(["click"]);const yi="_modalContainer_114dl_1",$i="_modalTitle_114dl_13",bi="_modalImages_114dl_21",wi="_visualList_114dl_39",Ci="_mediaContainer_114dl_44",Ii="_modalThumbs_114dl_115",xi="_fadeOut_114dl_168",Si="_thumbSlider_114dl_193",Mi="_thumbsLive_114dl_198",ki="_inputSlider_114dl_215",Pi="_onloadSlider_114dl_242",Ei="_editButton_114dl_260",Li="_finished_114dl_264",Ti="_canceled_114dl_270",V={modalContainer:yi,modalTitle:$i,modalImages:bi,visualList:wi,mediaContainer:Ci,modalThumbs:Ii,fadeOut:xi,thumbSlider:Si,thumbsLive:Mi,inputSlider:ki,onloadSlider:Pi,editButton:Ei,finished:Li,canceled:Ti},Di="_overlayImg_jr2ie_2",Bi="_seekBtn_jr2ie_26",Oi="_backward_jr2ie_37",Ai="_forward_jr2ie_42",Fi="_seekOverlay_jr2ie_47",zi="_isDoubleClick_jr2ie_69",Vi="_videoControler_jr2ie_75",Ni="_playbar_jr2ie_90",Ri="_videoSlider_jr2ie_128",Ui="_liveIcon_jr2ie_187",ji="_pulse_jr2ie_229",W={overlayImg:Di,seekBtn:Bi,backward:Oi,forward:Ai,seekOverlay:Fi,isDoubleClick:zi,videoControler:Vi,playbar:Ni,videoSlider:Ri,liveIcon:Ui,pulse:ji};var Zi=w("<div><header><button></button><button>");const Be=e=>g(Ee,{get children(){var t=Zi(),i=t.firstChild,s=i.firstChild,d=s.nextSibling;return t.style.setProperty("z-index","1"),t.style.setProperty("background","transparent"),ae(s,"click",e.onCancel,!0),u(s,Ut),u(i,()=>e.dropdown,d),ae(d,"click",e.onDone,!0),u(d,st),u(t,()=>e.children,null),P(n=>{var v=V.modalContainer,m=`${V.editButton} ${V.canceled}`,h=`${V.editButton} ${V.finished}`;return v!==n.e&&x(t,n.e=v),m!==n.t&&x(s,n.t=m),h!==n.a&&x(d,n.a=h),n},{e:void 0,t:void 0,a:void 0}),t}});N(["click"]);var Hi=w("<div>"),Gi=w('<footer class=footer_nav><div class="actions__toolbar__column is_left"><button>A</button></div><div class="actions__toolbar__column is_middle"><button>Reduce Frames</button></div><div class="actions__toolbar__column is_right"><button>B');const Wi=e=>{const{openModal:t,setOpenModal:i}=Z(),s=()=>e.media,d=()=>e.video,n=()=>i("isEditing",!1),v=()=>{i("isEditing",!1)};B(()=>{t.isEditing&&(d()&&!d().paused&&d().pause(),i("showImage",!0))});const m=async()=>{console.log("reducing frame")};return g(Be,{onCancel:n,onDone:v,get children(){return[(()=>{var h=Hi();return h.style.setProperty("color","white"),h})(),(()=>{var h=Gi(),$=h.firstChild,c=$.nextSibling,p=c.firstChild;return p.$$click=m,P(()=>p.disabled=s().frame_rate<=30),h})()]}})};N(["click"]);var Yi=w("<video preload=none controlslist=nodownload playsinline crossorigin=use-credentials><source><p>Your browser doesn't support the video tag."),qi=w('<img inert loading=lazy alt="Modal Image Overlay">',!0,!1),Ki=w("<div><button><div></div></button><button><div>"),Xi=w("<div><button class=buttonVideoPlayer></button><button class=buttonVideoPlayer></button><div><button></button><input type=range min=0>"),Ji=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M16.658 9.286c1.44.9 2.16 1.35 2.407 1.926a2 2 0 0 1 0 1.576c-.247.576-.967 1.026-2.407 1.926L9.896 18.94c-1.598.999-2.397 1.498-3.056 1.445a2 2 0 0 1-1.446-.801C5 19.053 5 18.111 5 16.226V7.774c0-1.885 0-2.827.394-3.358a2 2 0 0 1 1.446-.801c.66-.053 1.458.446 3.056 1.445l6.762 4.226Z">'),Qi=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="-0.5 0 25 25"><path stroke-width=0.1 d="M10 6.42a3 3 0 0 0-6 0v12a3 3 0 1 0 6 0v-12ZM20 6.42a3 3 0 1 0-6 0v12a3 3 0 1 0 6 0v-12Z">'),eo=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M21.998 8.34v7.32c0 1.5-1.63 2.44-2.93 1.69l-3.17-1.83-3.17-1.83-.49-.28v-2.82l.49-.28 3.17-1.83 3.17-1.83c1.3-.75 2.93.19 2.93 1.69Z"></path><path d="M12.241 8.34v7.32c0 1.5-1.63 2.44-2.92 1.69l-3.18-1.83-3.17-1.83c-1.29-.75-1.29-2.63 0-3.38l3.17-1.83 3.18-1.83c1.29-.75 2.92.19 2.92 1.69Z">'),to=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path d="M2 8.34v7.32c0 1.5 1.63 2.44 2.93 1.69l3.17-1.83 3.17-1.83.49-.28v-2.82l-.49-.28L8.1 8.48 4.93 6.65C3.63 5.9 2 6.84 2 8.34ZM11.762 8.34v7.32c0 1.5 1.63 2.44 2.92 1.69l3.18-1.83 3.17-1.83c1.29-.75 1.29-2.63 0-3.38l-3.17-1.83-3.18-1.83c-1.29-.75-2.92.19-2.92 1.69Z">'),no=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="0 0 24 24"><path stroke-width=1 d="M3 8.5a.5.5 0 0 1-1 0v-2A2.5 2.5 0 0 1 4.5 4h2a.5.5 0 0 1 0 1h-2A1.5 1.5 0 0 0 3 6.5v2ZM17.5 5a.5.5 0 1 1 0-1h2A2.5 2.5 0 0 1 22 6.5v2a.5.5 0 1 1-1 0v-2A1.5 1.5 0 0 0 19.5 5h-2ZM21 15.5a.5.5 0 1 1 1 0v2a2.5 2.5 0 0 1-2.5 2.5h-2a.5.5 0 1 1 0-1h2a1.5 1.5 0 0 0 1.5-1.5v-2ZM6.5 19a.5.5 0 1 1 0 1h-2A2.5 2.5 0 0 1 2 17.5v-2a.5.5 0 1 1 1 0v2A1.5 1.5 0 0 0 4.5 19h2Z">'),io=w('<svg xmlns=http://www.w3.org/2000/svg viewBox="5 5 61 61"><g fill=none><path stroke-linejoin=round stroke-miterlimit=10 stroke-width=4 d="M21 44h-7l-2-2V30l2-2h7"></path><path stroke-linejoin=round stroke-miterlimit=10 stroke-width=4 d="m21 43-1-1V30l1-1 12-13c2-2 4-1 4 1v37c0 3-2 4-4 2L21 43z">'),oo=w('<svg><path stroke-width=4 stroke-linecap=round stroke-miterlimit=10 d="m45 33 12 11m0-11L45 43"></svg>',!1,!0),ro=w('<svg><g fill=none><path stroke-width=4 stroke-linecap=round stroke-miterlimit=10 d="M48 28c4 4 4 12 0 16"></path><path stroke-width=4 stroke-linecap=round stroke-miterlimit=10 d="M54 23c6 6 6 20 0 26"></svg>',!1,!0);const lo=e=>{const t=()=>e.media,i=()=>e.isVisible,s=()=>e.childDim,d=B(()=>i()&&n);let n;const[v,m]=re({isLoading:!0,isPlaying:!1,currentTime:0,muted:!1,isFullScreen:!1}),{openModal:h}=Z(),{view:$}=ie();B(async()=>{if(!d())return n&&!n.paused?n.pause():void 0;!$.autoplay||!n||n.paused&&Ye(n)});const[c,p]=re({backward:!1,forward:!1}),f=l=>{p(l,!0),l==="backward"?uo(n):co(n),setTimeout(()=>p(l,!1),300)};return[(()=>{var l=Yi(),o=l.firstChild;return l.addEventListener("timeupdate",r=>m("currentTime",r.currentTarget.currentTime)),l.addEventListener("pause",()=>{m("isPlaying",!1)}),l.addEventListener("play",r=>{r.preventDefault(),m("isPlaying",!0)}),l.addEventListener("loadeddata",()=>m("isLoading",!1)),l.addEventListener("load",()=>m("isLoading",!0)),l.addEventListener("fullscreenchange",()=>m("isFullScreen",r=>!r)),ne(r=>n=r,l),P(r=>{var _={...s()},a=!v.isFullScreen,b=v.muted,y=`${tt}${t().source_file}`,S=t().mime_type;return r.e=Te(l,_,r.e),a!==r.t&&(l.inert=r.t=a),b!==r.a&&(l.muted=r.a=b),y!==r.o&&U(o,"src",r.o=y),S!==r.i&&U(o,"type",r.i=S),r},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),l})(),(()=>{var l=qi();return P(o=>{var r={[W.overlayImg]:!0,[W.pulse]:v.isLoading&&v.isPlaying},_=v.isLoading?1:0,a=t().thumb_path;return o.e=oe(l,r,o.e),_!==o.t&&((o.t=_)!=null?l.style.setProperty("opacity",_):l.style.removeProperty("opacity")),a!==o.a&&U(l,"src",o.a=a),o},{e:void 0,t:void 0,a:void 0}),l})(),g(A,{get when(){return d()},get children(){return[(()=>{var l=Ki(),o=l.firstChild,r=o.firstChild,_=o.nextSibling,a=_.firstChild;return o.$$dblclick=()=>f("backward"),u(r,ho),_.$$dblclick=()=>f("forward"),u(a,go),P(b=>{var y={[V.fadeOut]:h.showImage},S={[W.seekBtn]:!0,[W.backward]:!0,[W.isDoubleClick]:c.backward},M=W.seekOverlay,O={[W.seekBtn]:!0,[W.forward]:!0,[W.isDoubleClick]:c.forward},L=W.seekOverlay;return b.e=oe(l,y,b.e),b.t=oe(o,S,b.t),M!==b.a&&x(r,b.a=M),b.o=oe(_,O,b.o),L!==b.i&&x(a,b.i=L),b},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),l})(),(()=>{var l=Xi(),o=l.firstChild,r=o.nextSibling,_=r.nextSibling,a=_.firstChild,b=a.nextSibling;return o.$$click=()=>m("muted",y=>!y),u(o,()=>fo(v.muted)),r.$$click=y=>so(y,n),u(r,_o),a.$$click=async()=>Ye(n),u(a,(()=>{var y=K(()=>!!v.isPlaying);return()=>y()?mo():vo()})()),b.$$input=y=>{y.preventDefault(),n.currentTime=Number(y.target.value)},u(_,()=>t().video_duration,null),P(y=>{var S={[V.modalThumbs]:!0,[V.fadeOut]:h.showImage,[W.videoControler]:!0},M=W.playbar,O=W.videoSlider,L=`${v.currentTime/t().duration*100}%`,z=Math.round(t().duration);return y.e=oe(l,S,y.e),M!==y.t&&x(_,y.t=M),O!==y.a&&x(b,y.a=O),L!==y.o&&((y.o=L)!=null?b.style.setProperty("--currentProcess",L):b.style.removeProperty("--currentProcess")),z!==y.i&&U(b,"max",y.i=z),y},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P(()=>b.value=v.currentTime),l})()]}}),g(A,{get when(){return K(()=>!!h.isEditing)()&&d()},get children(){return g(Wi,{video:n,get media(){return t()}})}})]},Ye=e=>{if(e)return e.readyState<3&&e.load(),e.paused?e.play().catch(t=>console.warn("Autoplay blocked",t)):e.pause()},so=(e,t)=>{e.preventDefault(),t&&(t.requestFullscreen?t.requestFullscreen():t.webkitEnterFullscreen())},mt=(e,t)=>{if(!e||e.readyState<3||e.seekable.length===0)return;const i=e.duration;if(isNaN(i)||i<=0)return console.error("Invalid video duration.");const s=Math.min(Math.max(e.currentTime+t,0),i);try{if(e.currentTime===s)return;e.currentTime=s}catch(d){console.error("Error seeking video:",d)}},ao=10,co=e=>{e&&mt(e,ao)},uo=e=>{e&&mt(e,-10)},vo=()=>Ji(),mo=()=>Qi(),ho=()=>eo(),go=()=>to(),_o=()=>no(),fo=(e=!1)=>(()=>{var t=io(),i=t.firstChild,s=i.firstChild;return u(i,e?oo():ro(),s),t})();N(["dblclick","click","input"]);const po="_mainBrusher_1s8h0_1",yo="_inputBrusher_1s8h0_18",$o="_sizeBrusher_1s8h0_40",Ie={mainBrusher:po,inputBrusher:yo,sizeBrusher:$o};var bo=w("<div><canvas>"),wo=w("<div><div><label for=brushSize>Size</label><span>px</span></div><input id=brushSize type=range>"),Co=w('<footer class=footer_nav><div class="actions__toolbar__column is_left"><button></button></div><div class="actions__toolbar__column is_middle"><button> Remove</button></div><div class="actions__toolbar__column is_right"><button>');const ye={min:1,max:300},Io=e=>{const[t,i]=j(!1),[s,d]=j(50),[n,v]=re({x:0,y:0});let m,h;const $=o=>{const r=m.getBoundingClientRect(),_=m.width/r.width,a=m.height/r.height;return{x:(o.clientX-r.left)*_,y:(o.clientY-r.top)*a}};de(()=>{m.width=e.photo.naturalWidth,m.height=e.photo.naturalHeight,m.width>=m.height?(m.style.width="100%",m.style.height="auto"):(m.style.width="auto",m.style.height="100%");const o=m.getContext("2d");o&&(o.lineJoin="round",o.lineCap="round",o.lineWidth=s(),o.strokeStyle="white",h=o)});const c=o=>{i(!0);const r=$(o);v({x:r.x,y:r.y})},p=()=>{i(!1)},f=o=>{if(!t()||!h)return;const r=$(o);h.lineWidth=s(),h.beginPath(),h.moveTo(n.x,n.y),h.lineTo(r.x,r.y),h.stroke(),h.closePath(),v({x:r.x,y:r.y})},l=()=>{h&&h.clearRect(0,0,m.width,m.height)};return $e(()=>{h&&h.closePath()}),[(()=>{var o=bo(),r=o.firstChild;return r.$$mouseup=p,r.$$mousemove=f,r.$$mousedown=c,ne(_=>m=_,r),P(()=>x(o,Ie.mainBrusher)),o})(),g(A,{get when(){return!t()},get children(){return[(()=>{var o=wo(),r=o.firstChild,_=r.firstChild,a=_.nextSibling,b=a.firstChild,y=r.nextSibling;return u(a,s,b),y.$$input=S=>d(Number(S.target.value)),P(S=>{var M=Ie.inputBrusher,O=Ie.sizeBrusher,L=xo(s()),z=ye.min,T=ye.max;return M!==S.e&&x(o,S.e=M),O!==S.t&&x(r,S.t=O),L!==S.a&&((S.a=L)!=null?y.style.setProperty("background",L):y.style.removeProperty("background")),z!==S.o&&U(y,"min",S.o=z),T!==S.i&&U(y,"max",S.i=T),S},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P(()=>y.value=s()),o})(),(()=>{var o=Co(),r=o.firstChild,_=r.firstChild,a=r.nextSibling,b=a.firstChild,y=b.firstChild,S=a.nextSibling,M=S.firstChild;return u(_,jt),b.$$click=()=>{},u(b,lt,y),M.$$click=l,u(M,Zt),o})()]}})]},xo=e=>{const t=ye.min,i=ye.max,s=(e-t)/(i-t)*100;return`linear-gradient(to right, var(--button-active-color) 0%, var(--button-active-color) ${s}%, #ccc ${s}%, #ccc 100%)`};N(["mousedown","mousemove","mouseup","input","click"]);const So="_dropdownWrapper_15cn4_1",Mo="_customSelect_15cn4_6",qe={dropdownWrapper:So,customSelect:Mo};var ko=w("<div><select><option value=remove>Erase Unwanted</option><option value=replace>Replace Object</option><option value=generate>Generate Photos");const Po=()=>{const[e,t]=j("remove");return(()=>{var i=ko(),s=i.firstChild;return s.$$input=d=>t(d.currentTarget.value),P(d=>{var n=qe.dropdownWrapper,v=qe.customSelect;return n!==d.e&&x(i,d.e=n),v!==d.t&&x(s,d.t=v),d},{e:void 0,t:void 0}),P(()=>s.value=e()),i})()};N(["input"]);const Eo=e=>{const{setOpenModal:t}=Z(),i=()=>t("isEditing",!1),s=()=>{t("isEditing",!1)},{setView:d}=ie();return de(()=>d("modalObjFit",!0)),g(Be,{onCancel:i,onDone:s,get dropdown(){return Po()},get children(){return g(Io,{get photo(){return e.photo}})}})};var Lo=w('<img inert loading=lazy alt="Modal Image">',!0,!1),To=w('<img inert loading=lazy alt="Modal Image Overlay">',!0,!1);const Do=e=>{const t=()=>e.media,i=()=>e.isVisible,s=()=>e.childDim;let d;const{openModal:n}=Z(),v=B(()=>i()&&d),[m,h]=j(!0);return B(()=>{v()&&h(!1)}),[(()=>{var $=Lo();return $.addEventListener("error",()=>h(!0)),ne(c=>d=c,$),P(c=>{var p={...s()},f=t().source_file;return c.e=Te($,p,c.e),f!==c.t&&U($,"src",c.t=f),c},{e:void 0,t:void 0}),$})(),(()=>{var $=To();return P(c=>{var p=W.overlayImg,f=m()?1:0,l=t().thumb_path;return p!==c.e&&x($,c.e=p),f!==c.t&&((c.t=f)!=null?$.style.setProperty("opacity",f):$.style.removeProperty("opacity")),l!==c.a&&U($,"src",c.a=l),c},{e:void 0,t:void 0,a:void 0}),$})(),g(A,{get when(){return K(()=>!!n.isEditing)()&&v()},get children(){return g(Eo,{photo:d})}})]};var Bo=w("<div><div><div></div><input type=range min=0 step=any>"),Oo=w("<img inert>");const Ke=50,Ao=11,Fo=e=>{const t=()=>e.currentChild,i=()=>e.media,s=()=>e.isLoading,[d,n]=j([]),[v,m]=j(i().selected_frame),{setOpenModal:h}=Z();de(async()=>{e.setIsLoading(!0),await zo(t(),n),await ke(t(),i().selected_frame),e.setIsLoading(!1)});const $=async l=>{await ke(t(),l),m(l)},{items:c}=G(),{setDisplayMedia:p}=Z();return g(Be,{onCancel:()=>h("isEditing",!1),onDone:async()=>{(await Lt(i().media_id,v())).ok||alert("Failed to update frame position"),p([...c().keys()],"selected_frame",v()),h("isEditing",!1)},get children(){var l=Bo(),o=l.firstChild,r=o.firstChild,_=r.nextSibling;return l.style.setProperty("bottom","38px"),l.style.setProperty("align-items","start"),u(r,g(_t,{get each(){return d()},children:a=>(()=>{var b=Oo();return P(()=>U(b,"src",a().imageBase)),b})()})),_.$$input=a=>{a.preventDefault(),$(parseFloat(a.currentTarget.value))},P(a=>{var b=V.modalThumbs,y=V.thumbSlider,S=V.thumbsLive,M={[V.inputSlider]:!0,[V.onloadSlider]:s()},O=i().duration;return b!==a.e&&x(l,a.e=b),y!==a.t&&x(o,a.t=y),S!==a.a&&x(r,a.a=S),a.o=oe(_,M,a.o),O!==a.i&&U(_,"max",a.i=O),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),P(()=>_.value=v()),l}})},zo=async(e,t)=>{if(!e||!e.readyState)return;const i=e.videoWidth/e.videoHeight,s=document.createElement("canvas"),d=s.getContext("2d"),n=e.duration,v=n/Ao,m=[];s.height=Ke,s.width=Ke*i;for(let h=v;h<n;h+=v){await ke(e,h),d?.drawImage(e,0,0,s.width,s.height);const $=s.toDataURL("image/jpeg");m.push({imageBase:$,position:h})}t(m)};function ke(e,t){return new Promise(i=>{const s=()=>{e.removeEventListener("seeked",s),i()};e.addEventListener("seeked",s),e.currentTime=t})}N(["input"]);var Vo=w("<video inert controlslist=nodownload preload=none playsinline crossorigin=use-credentials><source><p>Your browser doesn't support the video tag."),No=w("<div><span>LIVE"),Ro=w('<img inert loading=lazy alt="Image not found">',!0,!1);const Uo=e=>{const t=()=>e.media,i=()=>e.isVisible,s=()=>e.childDim,{view:d}=ie();let n;const v=B(()=>i()&&n),m=e.clickableArea,[h,$]=j(!0);B(async()=>{if(!v())return $(!0);n.load(),$(!1)});const{openModal:c,setOpenModal:p}=Z(),{pressed:f}=ft({target:m});let l;B(()=>{!v()||!n||d.zoomLevel>1||(f()&&(l=setTimeout(async()=>(p("showImage",!0),await Xt(n)),200)),f()||(clearTimeout(l),n.paused||n.pause()))});const o=r=>{Xe(r,n,t().selected_frame)};return[(()=>{var r=Vo(),_=r.firstChild;return r.addEventListener("pause",a=>o(a)),r.addEventListener("play",a=>Xe(a,n,0)),r.addEventListener("loadeddata",a=>o(a)),r.addEventListener("load",()=>$(!0)),ne(a=>n=a,r),P(a=>{var b={...s()},y=`${tt}${t().source_file}`,S=t().mime_type;return a.e=Te(r,b,a.e),y!==a.t&&U(_,"src",a.t=y),S!==a.a&&U(_,"type",a.a=S),a},{e:void 0,t:void 0,a:void 0}),r})(),g(A,{get when(){return!c.showImage},get children(){var r=No(),_=r.firstChild;return u(r,Ht,_),P(()=>x(r,W.liveIcon)),r}}),(()=>{var r=Ro();return P(_=>{var a=W.overlayImg,b=h()?1:-1,y=t().thumb_path;return a!==_.e&&x(r,_.e=a),b!==_.t&&((_.t=b)!=null?r.style.setProperty("z-index",b):r.style.removeProperty("z-index")),y!==_.a&&U(r,"src",_.a=y),_},{e:void 0,t:void 0,a:void 0}),r})(),g(A,{get when(){return K(()=>!!c.isEditing)()&&v()},get children(){return g(Fo,{get media(){return t()},currentChild:n,get isLoading(){return h()},setIsLoading:$})}})]},Xe=(e,t,i)=>{t&&(e.preventDefault(),t.currentTime=i)};function jo(e){const{setView:t}=ie();let i=0;const{mouseGesture:s,setMouseGesture:d,resetMouse:n,translate:v,setTranslate:m}=Z(),h=(o,r)=>Math.hypot(r.clientX-o.clientX,r.clientY-o.clientY),$=o=>o instanceof MouseEvent?{x:o.clientX,y:o.clientY}:o.touches[0]?{x:o.touches[0].clientX,y:o.touches[0].clientY}:null,c=()=>{n()},p=o=>{const r=$(o);r&&"touches"in o&&o.touches.length===2&&(i=h(o.touches[0],o.touches[1]),d({action:"pinchZoom",status:!0,start:{x:r.x-v.x,y:r.y-v.y}}))},f=o=>{if(!(!$(o)||!i)&&s.action==="pinchZoom"&&"touches"in o&&o.touches.length===2){const _=h(o.touches[0],o.touches[1]),b=(_-i)/i*yt;t("zoomLevel",y=>Math.min(Math.max(y*(1+b),ot),rt)),i=_}},l=()=>{s.action==="pinchZoom"&&c()};de(()=>{if(!e)return;const o={passive:!1};e.addEventListener("touchstart",p,o),e.addEventListener("touchmove",f,o),e.addEventListener("touchend",l,o),e.addEventListener("touchcancel",l,o),e.addEventListener("mousedown",p,o),e.addEventListener("mousemove",f,o),e.addEventListener("mouseup",l,o),e.addEventListener("mouseleave",l,o),$e(()=>{e.removeEventListener("touchstart",p),e.removeEventListener("touchmove",f),e.removeEventListener("touchend",l),e.removeEventListener("touchcancel",l),e.removeEventListener("mousedown",p),e.removeEventListener("mousemove",f),e.removeEventListener("mouseup",l),e.removeEventListener("mouseleave",l)})})}var Zo=w("<div>"),Ho=w("<div>Unknown type");const Go=240,Wo=e=>{let t;const i=()=>e.media,s=()=>e.viewIndex,{view:d,setView:n}=ie(),[v,m]=j(!1),{openModal:h,setOpenModal:$}=Z();de(()=>{if(nt(t,([{isIntersecting:l}])=>{m(l),l&&(e.setSelectCurrentItem(s(),i().media_id),e.setLastEl&&e.setLastEl(t))},{threshold:.59}),!t||!t.children.length)return"";const f=t.children[0];it(f,l=>{if(!p().height)return;const[o]=l,{height:r}=o.contentRect;requestAnimationFrame(()=>{const _=r>window.innerHeight?"none":"center";document.documentElement.style.setProperty("--modal-center",_)})}),jo(t)});const c=Yo(n,v,h,$),p=B(()=>{if(!v()||d.zoomLevel<1)return{};const f=window.innerWidth<window.innerHeight,l=(1+.75*(d.zoomLevel-1))*100,o=d.zoomLevel===1?"100dvh":"none";return f?{width:`${l}%`,height:"auto","max-height":o}:{width:"auto",height:`${l}%`,"max-height":o}});return(()=>{var f=Zo();ae(f,"click",c,!0);var l=t;return typeof l=="function"?ne(l,f):t=f,u(f,g(fe,{get fallback(){return Ho()},get children(){return[g(te,{get when(){return i().file_type==="Photo"},get children(){return g(Do,{get media(){return i()},get isVisible(){return v()},get childDim(){return p()}})}}),g(te,{get when(){return i().file_type==="Video"},get children(){return g(lo,{get media(){return i()},get isVisible(){return v()},get childDim(){return p()}})}}),g(te,{get when(){return i().file_type==="Live"},get children(){return g(Uo,{get media(){return i()},get isVisible(){return v()},clickableArea:t,get childDim(){return p()}})}})]}})),P(o=>{var r={[V.mediaContainer]:!0},_=`${e.topPos}px`,a=d.zoomLevel>1?"scroll":"hidden",b=i().media_id;return o.e=oe(f,r,o.e),_!==o.t&&((o.t=_)!=null?f.style.setProperty("top",_):f.style.removeProperty("top")),a!==o.a&&((o.a=a)!=null?f.style.setProperty("overflow",a):f.style.removeProperty("overflow")),b!==o.o&&U(f,"data-modalid",o.o=b),o},{e:void 0,t:void 0,a:void 0,o:void 0}),f})()},Yo=(e,t,i,s)=>{let d=null;const n=v=>{if(!(v.target!==v.currentTarget||i.isEditing))if(v.preventDefault(),v.stopPropagation(),d){if(clearTimeout(d),d=null,!t())return;e("zoomLevel",m=>m>1?1:3)}else d=setTimeout(()=>{s("showImage",m=>!m),d=null},Go)};return $e(()=>{d&&clearTimeout(d)}),n};N(["click"]);var qo=w('<div><header><div class=buttonContainer><button></button></div><div><p></p><p></p></div><div class=buttonContainer><button popovertarget=more-modal-popover></button><div popover=auto id=more-modal-popover class="popover-container devices_filter_popover"><div class=media_type_contents><button></button><span>Zoom</span><button></button></div><div>Video Autoplay </div></div></div></header><div id=modalImages><div></div></div><div>');const Ko=3,Xo=100,se=window.innerHeight+Xo,Jo=se*Ko,Qo=Math.ceil(Jo/se)+2,er=e=>{const{openModal:t,setOpenModal:i,resetModal:s,displayMedias:d}=Z(),{items:n,setItems:v,setOneItem:m}=G(),{view:h,setView:$}=ie(),c=()=>{v(new Map),s()},[p,f]=re({elIndex:n().keys().next().value,elId:n().values().next().value});let l;const[o,r]=j(p.elIndex*se),_=B(()=>Math.max(0,Math.floor(o()/se)-1)),a=B(()=>Math.min(d.length-1,_()+Qo)),b=B(()=>d.length===0?(window.history.back(),[]):d.slice(_(),a()+1));B(()=>{_()>=d.length-1&&r((d.length-1)*se)}),de(()=>{Jt(p.elId),window.onpopstate=T=>{T.state&&(c(),je(p.elId,"nearest"))},it(l,T=>{})});const y=(T,I)=>{f({elId:I,elIndex:T}),m(p.elIndex,p.elId)},S=B(()=>{const T=d[p.elIndex];return T?Se(T.create_date):{date:"",time:""}}),M=()=>e.endIdxView(),O=()=>e.startIdxView(),L=T=>{T.preventDefault(),r(l.scrollTop),(p.elIndex===M()||p.elIndex===O())&&je(p.elId)};B(()=>{p.elId&&$("zoomLevel",1),document.documentElement.style.setProperty("--modal-center","center")}),B(()=>{const T=h.modalObjFit?"contain":"cover";document.documentElement.style.setProperty("--modal-object-fit",T)});const z=T=>{$("zoomLevel",I=>I+T)};return g(Ee,{get children(){var T=qo(),I=T.firstChild,k=I.firstChild,C=k.firstChild,D=k.nextSibling,R=D.firstChild,E=R.nextSibling,H=D.nextSibling,Y=H.firstChild,ee=Y.nextSibling,q=ee.firstChild,X=q.firstChild,he=X.nextSibling,ce=he.nextSibling,we=q.nextSibling;we.firstChild;var me=I.nextSibling,ge=me.firstChild,Oe=me.nextSibling;return T.style.setProperty("z-index","1"),I.style.setProperty("z-index","2"),C.$$click=()=>{window.history.back(),c()},u(C,Gt),u(R,()=>S().date),E.style.setProperty("font-size","12px"),u(E,()=>S().time),u(Y,Wt),X.$$click=()=>z(1),u(X,De),ce.$$click=()=>z(-1),u(ce,at),we.$$click=()=>$("autoplay",F=>!F),u(we,()=>h.autoplay?"ON":"OFF",null),me.addEventListener("scroll",L),ne(F=>l=F,me),u(ge,g(ve,{get each(){return b()},children:(F,ue)=>g(Wo,{get setLastEl(){return d.length-1===_()+ue()?e.setLastEl:void 0},get topPos(){return(_()+ue())*se},get viewIndex(){return _()+ue()},media:F,setSelectCurrentItem:y})})),u(Oe,g(vt,{})),P(F=>{var ue=V.modalContainer,ht={[V.fadeOut]:t.showImage},Ae=V.modalTitle,Fe=h.zoomLevel>=rt,ze=h.zoomLevel<=ot,Ve=V.modalImages,Ne=V.visualList,Ce=`${d.length*se}px`,gt={[V.fadeOut]:t.showImage};return ue!==F.e&&x(T,F.e=ue),F.t=oe(I,ht,F.t),Ae!==F.a&&x(D,F.a=Ae),Fe!==F.o&&(X.disabled=F.o=Fe),ze!==F.i&&(ce.disabled=F.i=ze),Ve!==F.n&&x(me,F.n=Ve),Ne!==F.s&&x(ge,F.s=Ne),Ce!==F.h&&((F.h=Ce)!=null?ge.style.setProperty("height",Ce):ge.style.removeProperty("height")),F.r=oe(Oe,gt,F.r),F},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),T}})};N(["click"]);var tr=w("<button popovertarget=filter-timeline>"),nr=w('<div popover=auto id=filter-timeline class="popover-container filter_timeline"><div class=media_type_contents><button></button><span>Zoom </span><button></button></div><div></div><div>Clear Filter</div><div class=media_type_contents>'),ir=w("<button>"),or=w("<span>"),rr=w("<div><span>Sort by ");const lr=1,sr=5,ar=()=>{const{view:e,params:t,setView:i,updatePage:s,updatePageKey:d}=ie(),{isSelected:n}=G(),v=[{label:"Photo",className:"photos"},{label:"Live",className:"lives"},{label:"Video",className:"videos"}],m=(p="")=>{d("filterType",p)},h=p=>{s({sortKey:p,sortOrder:t.sortOrder?0:1}),console.log(t.sortOrder)},$=[{type:"file_size",label:"Size"},{type:"create_date",label:"Created"},{type:"upload_at",label:"Uploaded"}],c=p=>{i("nColumn",f=>f+p)};return g(A,{get when(){return!n()},get children(){return[(()=>{var p=tr();return u(p,Yt),p})(),(()=>{var p=nr(),f=p.firstChild,l=f.firstChild,o=l.nextSibling,r=o.nextSibling,_=f.nextSibling,a=_.nextSibling,b=a.nextSibling;return l.$$click=()=>c(-1),u(l,De),r.$$click=()=>c(1),u(r,at),_.$$click=()=>i("objectFit",y=>!y),u(_,()=>e.objectFit?"Aspect Ratio Grid":"Square Photo Grid"),a.$$click=()=>m(),a.style.setProperty("font-size","smaller"),a.style.setProperty("text-decoration","underline"),a.style.setProperty("border","none"),a.style.setProperty("padding","10px 0 5px 15px"),u(b,g(ve,{each:v,children:({className:y,label:S})=>(()=>{var M=ir();return M.$$click=()=>m(S),P(()=>x(M,`icon_type ${y} ${t.filterType===S?"iconActiveFilter":""}`)),M})()})),u(p,g(ve,{each:$,children:({type:y,label:S})=>(()=>{var M=rr(),O=M.firstChild;return O.firstChild,M.$$click=()=>h(y),u(O,S,null),u(M,g(A,{get when(){return t.sortKey===y},get children(){var L=or();return u(L,(()=>{var z=K(()=>t.sortOrder===0);return()=>z()?qt():Kt()})()),L}}),null),P(()=>x(M,`sort_filter ${t.sortKey===y?"activeFilter":""}`)),M})()}),null),P(y=>{var S=e.nColumn===lr,M=e.nColumn===sr;return S!==y.e&&(l.disabled=y.e=S),M!==y.t&&(r.disabled=y.t=M),y},{e:void 0,t:void 0}),p})()]}})};N(["click"]);var dr=w("<p> - "),cr=w("<header><div inert><h1></h1></div><div class=buttonContainer>"),ur=w("<main class=mainHomePage><div><div> Photos and Videos");const vr=new Map([["favorite","Favorite"],["deleted","Recently Deleted"],["hidden","Hidden"],["duplicate","Duplicate"],["all","Library"],["album","Album"],["places","Places"],["search","Search"]]),mr=5,xe=3,Pe=90,hr=()=>{const e=Le(),{isSelected:t}=G(),{params:i,view:s,resetLibrary:d}=ie(),{openModal:n,displayMedias:v,setDisplayMedia:m}=Z();let h;const $=()=>({year:i.year,month:i.month,filterDevice:i.filterDevice,filterType:i.filterType,searchKey:i.searchKey,sortKey:i.sortKey,sortOrder:i.sortOrder,favorite:i.favorite,hidden:i.hidden,deleted:i.deleted,duplicate:i.duplicate,albumId:e.pages==="album"&&e.id?parseInt(e.id):void 0,locationId:e.pages==="places"&&e.id?parseInt(e.id):void 0}),[c,p]=j(0),[f,l]=j();de(()=>{nt(f,([{isIntersecting:k}])=>{k&&(l(null),p(C=>C+1))},{root:h,threshold:.5,rootMargin:"300px"})});const o=()=>{const k=en("idx",v.length-1);k&&l(k)},[r]=pe($,async k=>{const C=await Re(k);C&&(m(C),p(0),o())}),[_]=pe(c,async k=>{if(k===0)return;const C=await Re($(),k);C&&m(D=>[...D,...C])}),{width:a,height:b}=pt(),[y,S]=j(Pe),M=B(()=>a()/s.nColumn),O=B(()=>(Math.ceil(b()/M())+xe)*s.nColumn),L=B(()=>Math.max(0,(Math.floor(y()/M())-xe)*s.nColumn)),z=B(()=>Math.min(v.length-1,L()+O()+xe*s.nColumn)),T=B(()=>{if(v.length===0)return[];const k=L(),C=z();return v.slice(k,C+1)});$e(()=>d());const I=B(()=>{const k=e.pages==="all"?b()-170:b()-130;return Math.max(k,Math.ceil(v.length/s.nColumn)*M()+Pe)});return[(()=>{var k=cr(),C=k.firstChild,D=C.firstChild,R=C.nextSibling;return k.style.setProperty("z-index","1"),u(D,()=>vr.get(e.pages)),u(C,g(A,{get when(){return v.length},get children(){var E=dr(),H=E.firstChild;return u(E,()=>Je(v[L()]),H),u(E,()=>Je(v[z()]),null),E}}),null),R.style.setProperty("margin-top","10px"),u(R,g($n,{}),null),u(R,g(A,{get when(){return s.nColumn<=mr},get children(){return g(pi,{})}}),null),u(R,g(ar,{}),null),k})(),(()=>{var k=ur(),C=k.firstChild,D=C.firstChild,R=D.firstChild;return k.$$touchstart=()=>Qt(),k.addEventListener("scroll",E=>{E.preventDefault(),S(h.scrollTop)}),ne(E=>h=E,k),u(k,g(A,{get when(){return r.loading||_.loading},get children(){return g(dt,{})}}),C),u(k,g(A,{get when(){return!v.length},get children(){return g(Tt,{errorCode:"Not Found",message:"Page you're looking for could not be found"})}}),C),u(C,g(ve,{get each(){return T()},children:(E,H)=>g(_n,{get lastItem(){return v.length-1===L()+H()?l:void 0},media:E,get index(){return L()+H()},get itemDim(){return M()}})}),D),u(D,()=>v.length,R),P(E=>{var H=Q.virtualContainer,Y=`${v.length/s.nColumn*M()}px`,ee=Q.customBottomPadding,q=`${e.pages==="all"?140:100}px`,X=`${I()}px`;return H!==E.e&&x(C,E.e=H),Y!==E.t&&((E.t=Y)!=null?C.style.setProperty("height",Y):C.style.removeProperty("height")),ee!==E.a&&x(D,E.a=ee),q!==E.o&&((E.o=q)!=null?D.style.setProperty("height",q):D.style.removeProperty("height")),X!==E.i&&((E.i=X)!=null?D.style.setProperty("top",X):D.style.removeProperty("top")),E},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0}),k})(),g(A,{get when(){return t()},get children(){return g(vt,{})}}),g(A,{get when(){return n.isOpen},get children(){return g(er,{setLastEl:l,startIdxView:L,endIdxView:z})}})]},Je=e=>{if(!e)return"";const t=new Date(e.create_date),i=t.getDate(),s=t.toLocaleString("default",{month:"short"}),d=t.getFullYear();return`${s} ${i}, ${d}`};N(["touchstart"]);const Cr=()=>g(tn,{get children(){return g(nn,{get children(){return g(hr,{})}})}});export{Cr as default};
